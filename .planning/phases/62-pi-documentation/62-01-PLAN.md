---
phase: 62-pi-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - docs/HARNESSES.md
  - docs/CONFIGURATION.md
autonomous: true
requirements: [DOCS-01]

must_haves:
  truths:
    - "README.md lists pi as a supported harness alongside claude, opencode, codex, gemini"
    - "README.md shows --with-pi in setup examples and aishell pi in run examples"
    - "HARNESSES.md has a complete Pi section with overview, installation, authentication, usage, env vars, config dir, and tips"
    - "HARNESSES.md comparison table includes Pi column"
    - "HARNESSES.md authentication quick reference tables include Pi entries"
    - "CONFIGURATION.md lists --with-pi as an available harness selection flag"
    - "CONFIGURATION.md shows pi in harness_args examples"
  artifacts:
    - path: "README.md"
      provides: "Pi in harness list, setup, run, auth, and env var sections"
    - path: "docs/HARNESSES.md"
      provides: "Complete Pi harness section following Codex/Gemini pattern"
    - path: "docs/CONFIGURATION.md"
      provides: "Pi build flag and harness_args documentation"
  key_links:
    - from: "README.md"
      to: "docs/HARNESSES.md"
      via: "Pi listed in README, detailed in HARNESSES"
    - from: "docs/CONFIGURATION.md"
      to: "README.md"
      via: "--with-pi flag documented in both"
---

<objective>
Update the three primary user-facing documentation files (README.md, HARNESSES.md, CONFIGURATION.md) to include pi coding agent as a first-class harness.

Purpose: Users discovering aishell through README or consulting harness/config docs must see pi documented alongside claude, opencode, codex, and gemini.
Output: Three updated documentation files with complete pi coverage.
</objective>

<execution_context>
@/home/jonasrodrigues/.claude/get-shit-done/workflows/execute-plan.md
@/home/jonasrodrigues/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/60-pi-build-infrastructure/60-01-SUMMARY.md
@.planning/phases/60-pi-build-infrastructure/60-02-SUMMARY.md
@.planning/phases/61-pi-cli-integration/61-01-SUMMARY.md
@README.md
@docs/HARNESSES.md
@docs/CONFIGURATION.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update README.md with pi harness</name>
  <files>README.md</files>
  <action>
Add pi to every place where harnesses are listed in README.md. Follow the existing pattern exactly:

1. **Title line** (line 1 area): Add "Pi" to the parenthetical harness list: "(Claude Code, OpenCode, Codex CLI, Gemini CLI, Pi)"

2. **Authentication section** (~line 392): Add a Pi authentication subsection after Gemini, before OpenCode:
   - Mount `~/.pi` directory mentioned
   - Pi coding agent auth: API key via environment variable or pi config
   - Note: pi uses its own config at `~/.pi/`

3. **Environment Variables section** (~line 459): Add Pi-specific env vars to the "Harness-Specific Keys" table. No specific API key env var -- pi uses its own auth mechanism. Add PI_CODING_AGENT_DIR and PI_SKIP_VERSION_CHECK to the "Other" table section with appropriate descriptions.

4. **Setup examples** (~line 186): Add `aishell setup --with-pi` line to the single harness examples and include `--with-pi` in the multi-harness example.

5. **Run examples** (~line 203): Add `aishell pi` to the run harness examples.

6. **Foundation image contents** (~line 497): Add `fd` to the CLI tools list since it was added to foundation for pi.

Do NOT change the "Last updated" version tag in README.md (it doesn't have one). Preserve all existing content exactly; only add pi alongside existing harnesses.
  </action>
  <verify>
grep -c "pi" README.md should return multiple matches. Verify:
- grep "Pi" README.md shows pi in title and auth section
- grep "with-pi" README.md shows setup examples
- grep "aishell pi" README.md shows run examples
- grep "PI_CODING_AGENT_DIR" README.md shows env var
- grep "fd" README.md shows fd in tools list
  </verify>
  <done>README.md includes pi in: title, setup examples, run examples, authentication section, environment variables table, and foundation image contents (fd tool)</done>
</task>

<task type="auto">
  <name>Task 2: Add Pi section to HARNESSES.md and update comparison tables</name>
  <files>docs/HARNESSES.md</files>
  <action>
Add pi to HARNESSES.md following the exact pattern of the Gemini CLI section. Make these changes:

1. **"Last updated" line**: Change to `v3.5.0`

2. **What are Harnesses? list** (~line 9): Add `- **Pi** - Mario Zechner's autonomous coding agent`

3. **Harness Comparison table** (~line 42): Add Pi column:
   | Pi |
   | Mario Zechner |
   | API Key |
   | Standard |
   | No |
   | ~/.pi |
   | Autonomous coding |

4. **Add complete Pi section** after Gemini CLI section (before "## Multi-Container Workflow"):

## Pi

### Overview

Pi is an autonomous coding agent by Mario Zechner. It uses fd for file discovery and operates as a CLI tool for development tasks.

**Author:** Mario Zechner
**Package:** @mariozechner/pi-coding-agent

### Installation

```bash
# Latest version
aishell setup --with-pi

# Specific version
aishell setup --with-pi=1.0.0
```

**Build steps:**
1. Builds the foundation image (includes fd for pi's file discovery) -- skipped if cached
2. Creates a harness volume: `aishell-harness-{hash}`
3. Installs the Pi npm package into the volume: `npm install -g @mariozechner/pi-coding-agent`
4. Mounts the volume read-only at `/tools` in containers

**Updating Pi:**
```bash
aishell update
```

### Authentication

Pi uses its own authentication mechanism. Configure authentication through pi's config directory.

Set up authentication on your host:

```bash
# Authenticate on host first, then credentials persist in ~/.pi
pi auth
```

Or configure via environment:

The container mounts `~/.pi` automatically.

### Usage

Basic invocation:

```bash
aishell pi
```

Pass arguments to Pi:

```bash
aishell pi --help
aishell pi --print "hello"
```

Set default arguments in `config.yaml`:

```yaml
harnesses:
  pi:
    args: ["--print", "hello"]
```

### Environment Variables

| Variable | Purpose | Example |
|----------|---------|---------|
| `PI_CODING_AGENT_DIR` | Override pi's working directory | `/custom/path` |
| `PI_SKIP_VERSION_CHECK` | Skip version check on startup | `true` |

### Configuration Directory

- **Host:** `~/.pi`
- **Container:** `/root/.pi`

A volume mount preserves config across container restarts.

### Tips & Best Practices

1. **fd dependency:** Pi uses fd for file discovery, which is pre-installed in the foundation image
2. **Config persistence:** Authenticate on host; credentials mount automatically
3. **Session handling:** Each `aishell pi` invocation starts a new session
4. **File operations:** Pi has full filesystem access within the container

5. **Named containers section** (~line 520): Add `pi` to the default name list: `claude`, `opencode`, `codex`, `gemini`, `pi`, `vscode`, `shell`

6. **Running Multiple Harnesses section** (~line 566): Add `--with-pi` to the multi-harness build examples and `aishell pi "implement feature V"` to the switching examples.

7. **Configuration Management section** (~line 620): Add pi to the harness_args config.yaml example:
```yaml
  pi:
    args: ["--print", "hello"]
```

8. **Authentication Quick Reference tables**:
   - OAuth table: Add Pi row: `Pi | Config-based | âœ“ Standard`
   - API Key table: Add Pi row: `Pi | (config-based auth) | See pi documentation`
   - No Vertex AI row needed for Pi.

9. **Troubleshooting section at bottom**: No specific Pi auth troubleshooting needed (straightforward auth).
  </action>
  <verify>
grep -c "Pi" docs/HARNESSES.md should return many matches. Verify:
- grep "## Pi" docs/HARNESSES.md shows Pi section header
- grep "pi-coding-agent" docs/HARNESSES.md shows package name
- grep "with-pi" docs/HARNESSES.md shows installation examples
- grep "PI_CODING_AGENT_DIR" docs/HARNESSES.md shows env vars
  </verify>
  <done>HARNESSES.md includes: Pi in harness list, comparison table Pi column, complete Pi section (overview/install/auth/usage/env/config/tips), Pi in multi-container/multi-harness sections, Pi in auth quick reference tables</done>
</task>

<task type="auto">
  <name>Task 3: Update CONFIGURATION.md with --with-pi flag and pi harness_args</name>
  <files>docs/CONFIGURATION.md</files>
  <action>
Add pi to CONFIGURATION.md in all relevant sections:

1. **"Last updated" line**: Change to `v3.5.0`

2. **harness_args section** (~line 584):
   - Add `pi` to the "Harness names" line: `claude`, `opencode`, `codex`, `gemini`, `pi`
   - Add pi example to the harness_args YAML example:
     ```yaml
     pi:
       - "--print"
       - "hello"
     ```
   - Add pi row to "Common use cases" table:
     | Pi | `--print hello` | Default prompt |

3. **Setup Options / Harness Selection Flags section** (~line 998):
   - Add `--with-pi` to the "Available harnesses" list: `- --with-pi - Mario Zechner's Pi coding agent`
   - Add `--with-pi` to the multi-harness example:
     ```bash
     aishell setup --with-claude --with-opencode --with-codex --with-gemini --with-pi
     ```

4. **Per-Harness Model Configuration example** (~line 897): Add pi example alongside existing ones if it fits the pattern. Pi doesn't have a --model flag, so skip this specific example.

5. **Multi-Service Development Environment example** (~line 959): Add pi to harness_args if appropriate.

Preserve all existing content. Only add pi where other harnesses are listed.
  </action>
  <verify>
grep -c "pi" docs/CONFIGURATION.md should return multiple matches. Verify:
- grep "with-pi" docs/CONFIGURATION.md shows build flag
- grep "pi:" docs/CONFIGURATION.md shows harness_args entry
  </verify>
  <done>CONFIGURATION.md includes: --with-pi in available harnesses list, pi in harness_args examples and harness names list, pi in multi-harness setup example</done>
</task>

</tasks>

<verification>
After all tasks complete, verify documentation consistency:

1. README.md: `grep -E "(pi|Pi|PI_)" README.md` shows pi in title, setup, run, auth, env vars, and tools
2. HARNESSES.md: `grep "## Pi" docs/HARNESSES.md` confirms Pi section exists
3. CONFIGURATION.md: `grep "with-pi" docs/CONFIGURATION.md` confirms build flag documented
4. Cross-reference: Pi appears in all three files consistently
</verification>

<success_criteria>
- README.md lists pi as the 5th harness in all relevant sections
- HARNESSES.md has a complete Pi section following Gemini's structure
- CONFIGURATION.md documents --with-pi and pi harness_args
- No existing content is broken or removed
- "Last updated" tags reflect v3.5.0 where present
</success_criteria>

<output>
After completion, create `.planning/phases/62-pi-documentation/62-01-SUMMARY.md`
</output>
