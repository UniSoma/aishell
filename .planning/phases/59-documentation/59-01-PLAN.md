---
phase: 59-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - docs/ARCHITECTURE.md
  - docs/CONFIGURATION.md
autonomous: true

must_haves:
  truths:
    - "README.md shows Windows prerequisites (Docker Desktop WSL2, Babashka) and installation steps (download aishell + aishell.bat, add to PATH)"
    - "README.md Quick Start section includes Windows equivalent alongside Unix curl|bash"
    - "ARCHITECTURE.md documents cross-platform detection patterns (fs/windows?, platform-specific behaviors table)"
    - "ARCHITECTURE.md explains 'host-side platform detection, container-side Linux-only' principle"
    - "CONFIGURATION.md includes Windows path examples with forward-slash normalization notes"
    - "CONFIGURATION.md documents state-dir/config-dir platform differences"
  artifacts:
    - path: "README.md"
      provides: "Windows installation instructions alongside Unix"
      contains: "Docker Desktop"
    - path: "docs/ARCHITECTURE.md"
      provides: "Cross-platform architecture documentation"
      contains: "Platform Detection"
    - path: "docs/CONFIGURATION.md"
      provides: "Windows path examples and platform notes"
      contains: "Windows"
  key_links:
    - from: "README.md"
      to: "docs/CONFIGURATION.md"
      via: "Configuration docs link"
      pattern: "docs/CONFIGURATION.md"
    - from: "docs/ARCHITECTURE.md"
      to: "src/aishell/util.clj"
      via: "Platform detection reference"
      pattern: "babashka.fs/windows?"
---

<objective>
Update README.md, ARCHITECTURE.md, and CONFIGURATION.md with Windows support documentation.

Purpose: Users installing and configuring aishell on Windows need clear instructions, architecture rationale, and path examples. These three files are the most structured/concise updates in the documentation phase.

Output: Updated README.md with Windows installation, ARCHITECTURE.md with platform detection docs, CONFIGURATION.md with Windows path examples.
</objective>

<execution_context>
@/home/jonasrodrigues/.claude/get-shit-done/workflows/execute-plan.md
@/home/jonasrodrigues/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/59-documentation/59-RESEARCH.md
@.planning/phases/53-platform-detection/53-01-SUMMARY.md
@.planning/phases/54-path-handling/54-01-SUMMARY.md
@.planning/phases/54-path-handling/54-02-SUMMARY.md
@.planning/phases/55-host-identity/55-01-SUMMARY.md
@.planning/phases/56-process-execution/56-01-SUMMARY.md
@.planning/phases/57-terminal-output/57-01-SUMMARY.md
@.planning/phases/58-bat-wrapper/58-01-SUMMARY.md
@README.md
@docs/ARCHITECTURE.md
@docs/CONFIGURATION.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update README.md with Windows installation and prerequisites</name>
  <files>README.md</files>
  <action>
Update README.md with Windows support across three areas:

1. **Quick Start section** - Add a Windows PowerShell equivalent after the existing Unix curl|bash. Use a tabbed/side-by-side structure:
   - Unix stays as-is (curl | bash one-liner)
   - Windows: Download aishell + aishell.bat from GitHub Releases, place in LOCALAPPDATA\Programs\aishell, add to PATH
   - Both: `aishell setup --with-claude` and `aishell claude` work identically after install

2. **Prerequisites details section** (inside the existing `<details>` collapse) - Update:
   - Change "Requirements: Linux, macOS, or WSL2 on Windows" to explicitly list three platform categories:
     - Linux/macOS: Docker Engine + Babashka
     - Windows: Docker Desktop with WSL2 backend + Babashka (via Scoop or manual binary)
   - Add Windows PATH note: after installing, add the directory containing aishell.bat to PATH
   - Keep the existing `~/.local/bin` PATH tip for Unix

3. **Update "Last updated" metadata** - Bump version references to v3.1.0 where appropriate.

Do NOT:
- Remove any existing Unix content
- Create a separate "Windows Guide" document
- Add platform-specific emoji or icons
- Change the structure of other sections (they work for both platforms already)

Reference: Phase 58 Summary for .bat wrapper details, Phase 54 Summary for path handling.
  </action>
  <verify>
  - grep -n "Docker Desktop" README.md returns matches in prerequisites
  - grep -n "aishell.bat" README.md returns matches in installation section
  - grep -n "PowerShell" README.md returns matches
  - grep -n "Scoop\|scoop" README.md returns matches for Babashka install method
  - Existing Unix curl|bash one-liner still present unchanged
  - bb aishell.clj --help still works (no regressions from code, just doc changes)
  </verify>
  <done>
  README.md contains Windows installation instructions (Docker Desktop WSL2 + Babashka + aishell.bat), Quick Start has both Unix and Windows paths, and existing Unix content is preserved.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add cross-platform architecture section to ARCHITECTURE.md and Windows path notes to CONFIGURATION.md</name>
  <files>docs/ARCHITECTURE.md, docs/CONFIGURATION.md</files>
  <action>
**ARCHITECTURE.md changes:**

1. **Update "Last updated" to v3.1.0** at the top of the file.

2. **Add "Cross-Platform Architecture (v3.1.0+)" section** after the "Architecture Decisions" section (at the end of the file). Include:

   a. **Design Principles** subsection with three documented decisions:
      - "Host-side platform detection, container-side Linux-only" - Use babashka.fs/windows? for conditional logic on host, keep container images Linux-only. Docker Desktop WSL2 backend provides Linux containers on Windows.
      - "Forward-slash normalization at Docker boundary" - Use OS-native path separators internally, normalize to forward slashes via fs/unixify when constructing Docker commands.
      - "Platform-specific process execution" - p/exec on Unix for clean process tree replacement, p/process with :inherit on Windows for identical UX.

   b. **Platform-Specific Behaviors table** with columns: Aspect, Unix/macOS, Windows, Implementation Phase. Cover: Home directory, State directory, Path separators, UID/GID, Process exec, ANSI colors, CLI wrapper. (Reference the table from 59-RESEARCH.md Example 3.)

   c. **Container Environment note** - Containers are always Linux (Debian bookworm-slim) regardless of host platform. No Windows containers support.

3. **Add to Table of Contents** - Add "Cross-Platform Architecture" entry.

**CONFIGURATION.md changes:**

1. **Update "Last updated" to v3.1.0** at the top of the file.

2. **Update the mounts section** - Add a "Cross-Platform Path Notes" subsection after the existing mounts Notes, before the Merge behavior note. Include:
   - Home directory expansion: `~` expands to USERPROFILE on Windows, HOME on Unix. Forward slashes used in all Docker mount commands.
   - Explicit Windows paths: Use forward slashes (C:/Users/name/data:/data), not backslashes. aishell normalizes automatically via fs/unixify.
   - Source-only mounts on Windows: Map under /home/developer/ in container (not host path).
   - Example showing cross-platform mounts with inline comments.

3. **Add "Platform Differences" subsection** in the Configuration Files section (after Loading behavior). Document:
   - Config location: `~/.aishell/config.yaml` on all platforms (same)
   - State location: `~/.local/state/aishell/state.edn` on Unix, `%LOCALAPPDATA%\aishell\state.edn` on Windows
   - Both use the same YAML format

Reference: Phase 54 Summary for path details, Phase 55 Summary for UID/GID, Phase 56 Summary for process exec, Phase 57 Summary for ANSI colors.
  </action>
  <verify>
  - grep -n "v3.1.0" docs/ARCHITECTURE.md returns match on "Last updated" line
  - grep -n "Cross-Platform" docs/ARCHITECTURE.md returns section heading
  - grep -n "fs/windows?" docs/ARCHITECTURE.md returns at least one match
  - grep -n "v3.1.0" docs/CONFIGURATION.md returns match on "Last updated" line
  - grep -n "USERPROFILE\|LOCALAPPDATA" docs/CONFIGURATION.md returns matches
  - grep -n "forward slash\|fs/unixify\|forward-slash" docs/CONFIGURATION.md returns at least one match
  - Both files are valid Markdown (no broken links or formatting)
  </verify>
  <done>
  ARCHITECTURE.md has a "Cross-Platform Architecture" section documenting platform detection patterns, behaviors table, and container environment principle. CONFIGURATION.md has Windows path notes with forward-slash normalization guidance and platform-specific state/config location differences. Both files show v3.1.0 in "Last updated".
  </done>
</task>

</tasks>

<verification>
Overall phase checks for Plan 01:
1. README.md has Windows installation instructions (Docker Desktop, Babashka via Scoop, aishell.bat)
2. ARCHITECTURE.md documents cross-platform architecture with behaviors table
3. CONFIGURATION.md has Windows path examples and platform differences
4. All three files have consistent version references (v3.1.0)
5. No existing Unix content removed or broken
6. All Markdown formatting valid
</verification>

<success_criteria>
- README.md Quick Start has both Unix and Windows installation paths
- ARCHITECTURE.md has "Cross-Platform Architecture" section with platform behaviors table
- CONFIGURATION.md has Windows path notes with forward-slash normalization guidance
- All files updated to v3.1.0
</success_criteria>

<output>
After completion, create `.planning/phases/59-documentation/59-01-SUMMARY.md`
</output>
