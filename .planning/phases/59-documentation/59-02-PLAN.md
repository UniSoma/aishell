---
phase: 59-documentation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/TROUBLESHOOTING.md
  - docs/DEVELOPMENT.md
autonomous: true

must_haves:
  truths:
    - "TROUBLESHOOTING.md has Windows-Specific Issues section with symptom-based entries"
    - "TROUBLESHOOTING.md covers Docker Desktop WSL2 issues, path mounting problems, .bat wrapper issues, and color output problems"
    - "DEVELOPMENT.md lists Windows as a supported development platform alongside Linux/macOS"
    - "DEVELOPMENT.md has Testing on Windows section with platform-specific test scenarios"
    - "DEVELOPMENT.md explains path handling, process execution, and ANSI color test scenarios for Windows"
  artifacts:
    - path: "docs/TROUBLESHOOTING.md"
      provides: "Windows-specific troubleshooting entries"
      contains: "Windows-Specific Issues"
    - path: "docs/DEVELOPMENT.md"
      provides: "Windows testing and development instructions"
      contains: "Testing on Windows"
  key_links:
    - from: "docs/TROUBLESHOOTING.md"
      to: "docs/CONFIGURATION.md"
      via: "Config reference for path fixes"
      pattern: "CONFIGURATION.md"
    - from: "docs/DEVELOPMENT.md"
      to: "docs/ARCHITECTURE.md"
      via: "Architecture reference for platform patterns"
      pattern: "ARCHITECTURE.md"
---

<objective>
Update TROUBLESHOOTING.md with Windows-specific issues and DEVELOPMENT.md with Windows testing instructions.

Purpose: Windows users need symptom-based troubleshooting for common issues (WSL2, path mounting, .bat wrapper, color output). Contributors need to know how to test Windows support when adding features.

Output: Updated TROUBLESHOOTING.md with Windows section, DEVELOPMENT.md with Windows development/testing guide.
</objective>

<execution_context>
@/home/jonasrodrigues/.claude/get-shit-done/workflows/execute-plan.md
@/home/jonasrodrigues/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/59-documentation/59-RESEARCH.md
@docs/TROUBLESHOOTING.md
@docs/DEVELOPMENT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Windows-specific troubleshooting section to TROUBLESHOOTING.md</name>
  <files>docs/TROUBLESHOOTING.md</files>
  <action>
Update TROUBLESHOOTING.md with Windows-specific content:

1. **Update "Last updated" to v3.1.0** at the top.

2. **Add "Windows-Specific Issues" section** after the "Network Issues" section and before "Getting Help". Add to the Table of Contents as well.

3. **Add these symptom-based entries** (follow existing format in the file -- "### Symptom:", "**Cause:**", "**Resolution:**" with numbered steps):

   a. **"Docker daemon not running" on Windows** - Docker Desktop not started or WSL2 backend not enabled. Resolution: verify Docker Desktop running, check WSL2 backend (`docker info | Select-String "OSType"` should show linux), enable WSL2 if needed, verify WSL2 installation with `wsl --list --verbose`.

   b. **"No such file or directory" when mounting Windows path** - Path format not compatible with Docker. Resolution: use forward slashes in config (show incorrect backslash vs correct forward slash examples), avoid mixed separators, recommend tilde expansion for home directory, test with `Test-Path`.

   c. **"aishell.bat not recognized" in cmd.exe** - aishell.bat not in PATH or has incorrect line endings. Resolution: verify PATH includes aishell directory, test direct invocation, verify CRLF line endings, re-download if needed.

   d. **Colors not displaying correctly in PowerShell/cmd.exe** - Terminal doesn't support ANSI or NO_COLOR set. Resolution: recommend Windows Terminal, explain FORCE_COLOR=1 and NO_COLOR=1 env vars, mention legacy cmd.exe limitations.

   e. **Permission errors when building custom .aishell/Dockerfile on Windows** - File permissions or Docker buildx path mapping. Resolution: recommend WSL2 filesystem for project, check Docker Desktop file sharing settings, verify Dockerfile exists.

4. **Update Quick Diagnostics section** - Add Windows equivalents alongside existing bash commands:
   - Add PowerShell equivalent commands in a separate block labeled "Windows (PowerShell):"
   - Show `Get-Content ~/.aishell/state.edn` instead of `cat`, `docker info` works on both

5. **Update the "Docker not found" entry in Setup Issues** - Add Windows-specific Docker Desktop installation reference alongside existing Linux/macOS instructions. Add "Windows: Install Docker Desktop from https://www.docker.com/products/docker-desktop/" to the install step.

Reference: 59-RESEARCH.md Example 4 for troubleshooting entry structure and content.
  </action>
  <verify>
  - grep -n "Windows-Specific Issues" docs/TROUBLESHOOTING.md returns section heading
  - grep -n "Docker Desktop" docs/TROUBLESHOOTING.md returns multiple matches
  - grep -n "aishell.bat" docs/TROUBLESHOOTING.md returns at least one match
  - grep -n "PowerShell" docs/TROUBLESHOOTING.md returns multiple matches
  - grep -n "v3.1.0" docs/TROUBLESHOOTING.md returns match on "Last updated"
  - grep -c "### Symptom:" docs/TROUBLESHOOTING.md returns count >= 5 (existing + new)
  - Existing troubleshooting entries still present and unchanged
  </verify>
  <done>
  TROUBLESHOOTING.md has a "Windows-Specific Issues" section with 5 symptom-based entries covering Docker Desktop WSL2, path mounting, .bat wrapper, color output, and permission issues. Quick Diagnostics includes Windows commands. Version updated to v3.1.0.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Windows development and testing section to DEVELOPMENT.md</name>
  <files>docs/DEVELOPMENT.md</files>
  <action>
Update DEVELOPMENT.md with Windows development and testing instructions:

1. **Update "Last updated" to v3.1.0** at the top.

2. **Update Prerequisites section** - Add Windows alongside existing Linux/macOS:
   - Change "Linux or macOS" to "Linux, macOS, or Windows 10/11"
   - Add "Docker Desktop with WSL2 backend" for Windows alongside "Docker Engine" for Linux/macOS
   - Add note: Babashka 1.0+ (via Scoop on Windows, or manual binary)

3. **Update "Clone and Run from Source" section** - Add Windows PowerShell equivalent commands:
   - Same `git clone` works on Windows
   - `bb -m aishell.core setup --with-claude` works identically
   - `bb -m aishell.core claude` works identically
   - Note: `bb -m aishell.core` is cross-platform, no platform-specific source changes needed

4. **Add "Testing on Windows" section** after the existing "Testing Locally" section. Include:

   a. **Prerequisites for Windows Development** - Windows 10/11 with WSL2, Docker Desktop with WSL2 backend, Babashka installed, PowerShell 7+ recommended.

   b. **Platform-Specific Test Scenarios** - When testing Windows support, verify these 5 scenarios:

   - **Path Handling** - Test Windows path normalization in Docker commands. Run `bb -m aishell.core claude`, verify container starts. Test config mount with Windows path format.

   - **State Directory** - Verify Windows uses LOCALAPPDATA. Check `$env:LOCALAPPDATA\aishell` for state.edn after first run.

   - **Process Execution** - Test that attach works using p/process (not p/exec on Windows). Start harness, open another terminal, run attach.

   - **ANSI Color Output** - Test color detection with `bb -m aishell.core --help` (should show colors in Windows Terminal). Test `NO_COLOR=1` override.

   - **Batch Wrapper Generation** - Test `bb scripts/build-release.clj`, verify dist/aishell.bat has 4 lines and CRLF endings.

   c. **Cross-Platform Development Patterns** - Brief section for contributors:
   - Use `babashka.fs/windows?` for platform detection (not manual OS checks)
   - Use `fs/path` for path construction (not string concatenation with `/`)
   - Use `fs/unixify` at Docker mount boundaries
   - Guard `p/exec` calls with platform check, use `p/process {:inherit true}` on Windows
   - Guard `chmod` calls with `(when-not (fs/windows?) ...)`
   - Reference ARCHITECTURE.md cross-platform section for full patterns

   d. **Testing Without Windows Machine** - Brief note that simulating Windows path behavior on Unix/macOS is limited. Recommend real Windows testing for significant path/process changes. Note CI/CD limitations.

5. **Update Table of Contents** - Add "Testing on Windows" entry.

Reference: 59-RESEARCH.md Example 5 for testing section structure.
  </action>
  <verify>
  - grep -n "v3.1.0" docs/DEVELOPMENT.md returns match on "Last updated"
  - grep -n "Testing on Windows" docs/DEVELOPMENT.md returns section heading
  - grep -n "Windows 10" docs/DEVELOPMENT.md returns at least one match
  - grep -n "fs/windows?" docs/DEVELOPMENT.md returns at least one match
  - grep -n "fs/unixify" docs/DEVELOPMENT.md returns at least one match
  - grep -n "p/process" docs/DEVELOPMENT.md returns at least one match
  - Existing development content (Adding a New Harness checklist, Testing Locally, etc.) preserved
  </verify>
  <done>
  DEVELOPMENT.md has Windows listed as supported platform, "Testing on Windows" section with 5 platform-specific test scenarios, cross-platform development patterns for contributors, and version updated to v3.1.0.
  </done>
</task>

</tasks>

<verification>
Overall phase checks for Plan 02:
1. TROUBLESHOOTING.md has Windows-Specific Issues section with symptom-based entries
2. DEVELOPMENT.md has Testing on Windows section with test scenarios
3. Both files updated to v3.1.0
4. No existing content removed or broken
5. All Markdown formatting valid
6. Table of Contents updated in both files
</verification>

<success_criteria>
- TROUBLESHOOTING.md has >= 5 new Windows-specific symptom entries
- DEVELOPMENT.md has Testing on Windows section with platform-specific scenarios and development patterns
- Both files show v3.1.0 in Last updated
- Existing content preserved in both files
</success_criteria>

<output>
After completion, create `.planning/phases/59-documentation/59-02-SUMMARY.md`
</output>
