# Requirements Archive: v1.0 MVP

**Archived:** 2026-01-18
**Status:** SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: Agentic Harness Sandbox

**Defined:** 2026-01-17
**Core Value:** Run agentic AI harnesses in isolated, reproducible environments without polluting the host system.

## v1 Requirements

Requirements for initial release. Each maps to roadmap phases.

### Container Core

- [x] **CORE-01**: Container mounts project at same path as host (e.g., /home/user/project -> /home/user/project in container)
- [x] **CORE-02**: Container is ephemeral (destroyed on exit, only mounted files persist)
- [x] **CORE-03**: Files created in container have correct host UID/GID ownership
- [x] **CORE-04**: Container runs as non-root user with sudo access
- [x] **CORE-05**: Basic CLI tools available (git, curl, vim, jq, ripgrep)
- [x] **CORE-06**: Projects can extend base image via Dockerfile.sandbox

### Git Integration

- [x] **GIT-01**: Git user.name and user.email from host ~/.gitconfig work in container
- [x] **GIT-02**: Git recognizes project directory as safe (no dubious ownership errors)

### Harness Support

- [x] **HARNESS-01**: User can run Claude Code with `<command> claude`
- [x] **HARNESS-02**: User can run OpenCode with `<command> opencode`
- [x] **HARNESS-03**: User can enter shell with `<command>` (no arguments)
- [x] **HARNESS-04**: Claude Code config (~/.claude, ~/.claude.json) mounted from host
- [x] **HARNESS-05**: OpenCode config (~/.config/opencode) mounted from host
- [x] **HARNESS-06**: Claude Code is installed and runnable in container
- [x] **HARNESS-07**: OpenCode is installed and runnable in container

### Distribution

- [x] **DIST-01**: Tool installable via curl | bash one-liner
- [x] **DIST-02**: Works on Linux with Docker Engine
- [x] **DIST-03**: Installation creates command available in PATH
- [x] **DIST-04**: Base Docker image published or buildable locally

### Version Pinning

- [x] **VERSION-01**: User can specify `--claude-version=X.Y.Z` for specific Claude Code version
- [x] **VERSION-02**: User can specify `--opencode-version=X.Y.Z` for specific OpenCode version
- [x] **VERSION-03**: Without version flags, latest version is installed (current behavior)
- [x] **VERSION-04**: Version is baked into image tag for caching (e.g., `aishell:claude-1.0.5`)

### User Experience

- [x] **UX-01**: Container shell prompt is concise (not full absolute path)
- [x] **UX-02**: Claude Code runs with `--dangerously-skip-permissions` by default in container (configurable)

### Developer Tooling

- [x] **DEV-01**: Node.js LTS available in container (`node --version`, `npm --version`)
- [x] **DEV-02**: Babashka (bb) available in container (`bb --version`)
- [~] **DEV-03**: ~~bbin available in container~~ (Descoped: requires Java runtime)

### Build/Update Commands

- [x] **BUILD-01**: Explicit `aishell build` command creates container image
- [x] **BUILD-02**: Build flags (--with-claude, --with-opencode) persisted to state file
- [x] **BUILD-03**: Run commands require prior build (clear error messages if missing)
- [x] **UPDATE-01**: `aishell update` rebuilds with saved flags (--no-cache by default)

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Git Integration (Enhanced)

- **GIT-03**: SSH agent forwarding for git push/pull to private repos
- **GIT-04**: HTTPS credential helper passthrough
- **GIT-05**: GPG signing passthrough for signed commits

### Platform Support

- **PLAT-01**: Works on macOS with Docker Desktop
- **PLAT-02**: Installable via Homebrew tap
- **PLAT-03**: macOS SSH agent socket handling

### Advanced Features

- **ADV-01**: Auto-detect which harnesses are installed on host
- **ADV-02**: Named volumes for cache persistence (npm, cargo, pip)
- **ADV-03**: Network allowlist for security-conscious users
- **ADV-04**: Resource limits (CPU, memory) configuration

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Windows support | Docker Engine on Windows is complex; defer indefinitely |
| Persistent containers | Ephemeral is core design; named sessions contradict core value |
| Multiple accounts | Use separate config directories; not a v1 concern |
| GUI integration | CLI-focused tool; GUI support adds complexity |
| IDE plugins | Users can configure IDE to use CLI; not needed |
| Podman support | Different socket/API; research needed if requested |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| CORE-01 | Phase 1 | Complete |
| CORE-02 | Phase 1 | Complete |
| CORE-03 | Phase 1 | Complete |
| CORE-04 | Phase 1 | Complete |
| CORE-05 | Phase 1 | Complete |
| CORE-06 | Phase 4 | Complete |
| GIT-01 | Phase 2 | Complete |
| GIT-02 | Phase 2 | Complete |
| HARNESS-01 | Phase 3 | Complete |
| HARNESS-02 | Phase 3 | Complete |
| HARNESS-03 | Phase 3 | Complete |
| HARNESS-04 | Phase 3 | Complete |
| HARNESS-05 | Phase 3 | Complete |
| HARNESS-06 | Phase 3 | Complete |
| HARNESS-07 | Phase 3 | Complete |
| DIST-01 | Phase 5 | Complete |
| DIST-02 | Phase 1 | Complete |
| DIST-03 | Phase 5 | Complete |
| DIST-04 | Phase 1 | Complete |
| VERSION-01 | Phase 6 | Complete |
| VERSION-02 | Phase 6 | Complete |
| VERSION-03 | Phase 6 | Complete |
| VERSION-04 | Phase 6 | Complete |
| UX-01 | Phase 6 | Complete |
| UX-02 | Phase 6 | Complete |
| DEV-01 | Phase 7 | Complete |
| DEV-02 | Phase 7 | Complete |
| DEV-03 | Phase 7 | Descoped |
| BUILD-01 | Phase 8 | Complete |
| BUILD-02 | Phase 8 | Complete |
| BUILD-03 | Phase 8 | Complete |
| UPDATE-01 | Phase 8 | Complete |

**Coverage:**
- v1 requirements: 31 total (1 descoped)
- Mapped to phases: 31
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 30 of 31 v1 requirements (1 descoped)
**Adjusted:** None
**Dropped:** DEV-03 (bbin) â€” requires Java runtime, significantly increases image size

---
*Archived: 2026-01-18 as part of v1.0 milestone completion*
