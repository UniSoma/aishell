# Requirements Archive: v3.1.0 Native Windows Support

**Archived:** 2026-02-12
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: Agentic Harness Sandbox

**Defined:** 2026-02-11
**Core Value:** Run agentic AI harnesses in isolated, reproducible environments without polluting the host system

## v3.1.0 Requirements

Requirements for native Windows host support (cmd.exe/PowerShell with Linux containers via Docker Desktop).

### Platform Detection

- [x] **PLAT-01**: Platform detection utility (`windows?`) available for conditional host-side logic — shipped Phase 53
- [x] **PLAT-02**: All host-side Unix-specific code paths guarded by platform detection (no unguarded `id`, `p/exec`, or Unix path assumptions) — shipped Phase 53

### Process & Execution

- [x] **PROC-01**: `aishell attach <name>` works on Windows using `p/process` with `:inherit` instead of `p/exec` — shipped Phase 56
- [x] **PROC-02**: `aishell <harness>` (claude, opencode, etc.) works on Windows — docker run invocation succeeds — shipped Phase 56

### Path Handling

- [x] **PATH-01**: `get-home` returns correct home directory on Windows (`USERPROFILE` fallback) — shipped Phase 54
- [x] **PATH-02**: `expand-path` handles Windows backslash paths correctly — shipped Phase 54
- [x] **PATH-03**: State/config directories use `LOCALAPPDATA` on Windows instead of XDG — shipped Phase 54
- [x] **PATH-04**: Volume mount source paths normalized for Docker Desktop (backslashes to forward slashes) — shipped Phase 54

### Host Identity

- [x] **ID-01**: UID/GID detection defaults to 1000/1000 on Windows instead of calling `id -u`/`id -g` — shipped Phase 55
- [x] **ID-02**: Git config extraction (`git config user.name/user.email`) works on Windows — shipped Phase 55

### Terminal & Output

- [x] **TERM-01**: ANSI color codes auto-detected and stripped when terminal lacks support (check `WT_SESSION`, `TERM`, `ConEmuANSI`) — shipped Phase 57
- [x] **TERM-02**: TERM/COLORTERM have sensible defaults when not set (Windows doesn't set these) — shipped Phase 57

### Distribution

- [x] **DIST-01**: `aishell.bat` wrapper enables running `aishell` from Windows PATH without `bb` prefix — shipped Phase 58

### Documentation

- [x] **DOCS-01**: All user-facing CLI changes reflected in docs/ (README, ARCHITECTURE, CONFIGURATION, HARNESSES, TROUBLESHOOTING, DEVELOPMENT) — shipped Phase 59

## Future Requirements

### Windows Distribution

- **WDIST-01**: Scoop package manifest for automated installation
- **WDIST-02**: PowerShell installer script (install.ps1)
- **WDIST-03**: Automated Windows CI/CD testing pipeline

### Native Windows Containers

- **WCON-01**: Windows-native Dockerfile with PowerShell entrypoint
- **WCON-02**: ACL-based permission management replacing UID/GID system

## Out of Scope

| Feature | Reason |
|---------|--------|
| Native Windows containers | Linux containers via Docker Desktop cover 95%+ of Windows Docker users; separate Dockerfile/entrypoint required |
| Scoop/winget packaging | Users install babashka and docker manually; packaging deferred |
| PowerShell installer (install.ps1) | Not needed when babashka + docker assumed available |
| Windows CI/CD pipeline | No Windows test environment available; manual testing only |
| WSL2-only mode | Targeting native cmd.exe/PowerShell, not WSL2 shell |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| PLAT-01 | Phase 53 | Shipped |
| PLAT-02 | Phase 53 | Shipped |
| PROC-01 | Phase 56 | Shipped |
| PROC-02 | Phase 56 | Shipped |
| PATH-01 | Phase 54 | Shipped |
| PATH-02 | Phase 54 | Shipped |
| PATH-03 | Phase 54 | Shipped |
| PATH-04 | Phase 54 | Shipped |
| ID-01 | Phase 55 | Shipped |
| ID-02 | Phase 55 | Shipped |
| TERM-01 | Phase 57 | Shipped |
| TERM-02 | Phase 57 | Shipped |
| DIST-01 | Phase 58 | Shipped |
| DOCS-01 | Phase 59 | Shipped |

**Coverage:**
- v3.1.0 requirements: 14 total
- Mapped to phases: 14 (100%)
- Unmapped: 0

---
*Requirements defined: 2026-02-11*
*Last updated: 2026-02-11 after roadmap creation*
