# Milestone v1.0: MVP

**Status:** SHIPPED 2026-01-18
**Phases:** 1-8
**Total Plans:** 16

## Overview

This milestone delivered a Docker-based sandbox for running agentic AI harnesses (Claude Code, OpenCode) in isolated containers. The journey started with core container foundations (mounting, permissions, tools), added git integration for seamless version control, integrated the AI harnesses themselves, enabled per-project customization, and concluded with distribution for easy installation.

## Phases

### Phase 1: Core Container Foundation

**Goal**: Users can enter an ephemeral container with their project mounted at the exact host path, correct file ownership, and basic CLI tools available
**Depends on**: Nothing (first phase)
**Plans**: 3 plans

Plans:
- [x] 01-01-PLAN.md — Docker image foundation (Dockerfile, entrypoint, bashrc)
- [x] 01-02-PLAN.md — CLI script (aishell) with Docker integration
- [x] 01-03-PLAN.md — Human verification of all Phase 1 requirements

**Completed:** 2026-01-17

### Phase 2: Git Integration

**Goal**: Users can make git commits inside the container with their identity and without ownership warnings
**Depends on**: Phase 1
**Plans**: 1 plan

Plans:
- [x] 02-01-PLAN.md — Git identity propagation and safe.directory configuration

**Completed:** 2026-01-17

### Phase 3: Harness Integration

**Goal**: Users can run Claude Code and OpenCode harnesses with their configurations mounted
**Depends on**: Phase 2
**Plans**: 4 plans

Plans:
- [x] 03-01-PLAN.md — Dockerfile: conditional harness installation with build args
- [x] 03-02-PLAN.md — aishell: subcommand parsing, config mounting, env passthrough
- [x] 03-03-PLAN.md — Human verification of all HARNESS requirements
- [x] 03-04-PLAN.md — Fix OpenCode XDG state directory (gap closure)

**Completed:** 2026-01-17

### Phase 4: Project Customization

**Goal**: Projects can extend the base environment with additional dependencies via .aishell/Dockerfile
**Depends on**: Phase 3
**Plans**: 1 plan

Plans:
- [x] 04-01-PLAN.md — Extension detection, building, caching, and verification

**Completed:** 2026-01-18

### Phase 5: Distribution

**Goal**: Users can install the tool with a single command and have it available in PATH
**Depends on**: Phase 4
**Plans**: 1 plan

Plans:
- [x] 05-01-PLAN.md — Self-contained aishell with heredocs and curl|bash installer

**Completed:** 2026-01-18

### Phase 6: Final Enhancements

**Goal**: Polish the user experience with version pinning, shorter shell prompt, and auto-skip permissions in sandboxed environment
**Depends on**: Phase 5
**Plans**: 2 plans

Plans:
- [x] 06-01-PLAN.md — Version pinning: CLI flags, Dockerfile args, image tagging
- [x] 06-02-PLAN.md — UX improvements: PROMPT_DIRTRIM, --dangerously-skip-permissions

**Completed:** 2026-01-18

### Phase 7: Node.js and Clojure Tooling

**Goal**: Base image includes stable Node.js LTS and Babashka (bb) for enhanced scripting capabilities
**Depends on**: Phase 6
**Plans**: 1 plan

Plans:
- [x] 07-01-PLAN.md — Multi-stage Dockerfile with Node.js and Babashka installation

**Completed:** 2026-01-18

### Phase 8: Explicit Build/Update Commands

**Goal**: Separate build and run concerns with explicit subcommands, persist build configuration for updates
**Depends on**: Phase 7
**Plans**: 3 plans

Plans:
- [x] 08-01-PLAN.md — State management infrastructure (state file read/write/validate)
- [x] 08-02-PLAN.md — Build and update subcommands with state persistence
- [x] 08-03-PLAN.md — Run command guards and human verification

**Completed:** 2026-01-18

---

## Milestone Summary

**Key Decisions:**

- Debian bookworm-slim over Alpine for glibc compatibility
- gosu 1.19 for user switching (proper PID 1 handling)
- Dynamic user creation at runtime for UID/GID matching
- Git safe.directory configured in entrypoint after home dir creation
- Heredoc embedding for self-contained distribution
- Explicit build command separates concerns better than auto-build
- State file for flags (persistent config without JSON complexity)
- Multi-stage build for Node.js binaries without full runtime overhead

**Issues Resolved:**

- Harness binary access after privilege drop (copy to /usr/local/bin instead of symlinks)
- Home directory mismatch (pass LOCAL_HOME, create user with matching home)
- OpenCode XDG state directory EACCES errors (create XDG dirs at startup)
- verbose() function exit code issue (add || true fallback)

**Issues Deferred:**

- SSH agent forwarding (v1.1)
- HTTPS credential helper passthrough (v1.1)
- GPG signing passthrough (v1.1)
- macOS support (v1.1)
- Windows support (indefinitely)

**Technical Debt Incurred:**

- DEV-03 (bbin) descoped — requires Java runtime, increases image size
- get_base_image_id() function defined but unused (dead code, minor)

---

*For current project status, see .planning/ROADMAP.md*

---
*Archived: 2026-01-18 as part of v1.0 milestone completion*
