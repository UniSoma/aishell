# Milestone v2.10.0: Gitleaks Opt-in

**Status:** âœ… SHIPPED 2026-02-05
**Phases:** 44-45
**Total Plans:** 4

## Overview

Flip Gitleaks from opt-out to opt-in. Users who want Gitleaks scanning must explicitly request it at build time with `--with-gitleaks`. Filename-based detection continues to work independently.

## Phases

### Phase 44: Flip Gitleaks Default

**Goal**: Gitleaks installation requires explicit opt-in at build time
**Depends on**: Phase 43 (v2.9.0 complete)
**Requirements**: BUILD-01, BUILD-02, HELP-01, PIPE-01, PIPE-02
**Plans**: 2 plans

Plans:
- [x] 44-01: Flip Gitleaks default from opt-out to opt-in (ARG, CLI flag, help, defaults)
- [x] 44-02: Gate gitleaks staleness warning on :with-gitleaks state (gap closure)

**Details:**
- Flipped ARG WITH_GITLEAKS default from true to false in Dockerfile template
- Replaced --without-gitleaks with --with-gitleaks in CLI spec and help
- Updated default value logic to opt-in (nil -> false, true -> true)
- All build options now follow consistent --with-* positive flag pattern
- Gated runtime staleness warning on :with-gitleaks state to prevent confusion
- Users without Gitleaks never see "Gitleaks scan is missing" warnings

### Phase 45: Documentation Updates

**Goal**: Documentation reflects the new Gitleaks opt-in default
**Depends on**: Phase 44
**Requirements**: DOCS-01, DOCS-02, DOCS-03, DOCS-04
**Plans**: 2 plans

Plans:
- [x] 45-01: Update README.md and CONFIGURATION.md with opt-in Gitleaks semantics
- [x] 45-02: Update TROUBLESHOOTING.md and ARCHITECTURE.md with opt-in Gitleaks semantics

**Details:**
- README.md describes Gitleaks as opt-in with --with-gitleaks requirement
- CONFIGURATION.md section renamed from --without-gitleaks to --with-gitleaks
- TROUBLESHOOTING.md adds "gitleaks command not found" resolution pointing to --with-gitleaks
- ARCHITECTURE.md updated: design principles, foundation contents, build diagram, state.edn example, FAQ

---

## Milestone Summary

**Key Decisions:**
- Positive flag pattern: All build options use --with-* flags (no negative --without-* flags)
- Opt-in semantics: When :with-gitleaks absent from state, default to false (not installed)
- Backward compatibility: Existing state files with :with-gitleaks true continue to work
- Conditional warning display: Warnings only display when relevant to user's build configuration

**Issues Resolved:**
- PIPE-01 gap: staleness warning was shown even when Gitleaks not installed (fixed in 44-02)

**Issues Deferred:**
None.

**Technical Debt Incurred:**
None. All features complete and production-ready.

---

_For current project status, see .planning/ROADMAP.md_

---
*Archived: 2026-02-05 as part of v2.10.0 milestone completion*
