# AIShell per-project configuration
# All options are optional - only include what you need

# =============================================================================
# EXTENDS - Config inheritance strategy
# =============================================================================
# Controls how this project config relates to global (~/.aishell/config.yaml):
#   - "global" (default): Merge with global config
#       - Lists (mounts, ports, docker_args): concatenate (global + project)
#       - Maps (env): shallow merge (project overrides global)
#       - Scalars (pre_start): project replaces global
#   - "none": This config fully replaces global (no merging)

extends: global

# =============================================================================
# MOUNTS - Additional directories to mount into container
# =============================================================================
# Supports two formats:
#   - source-only: mounts at same path inside container
#   - source:dest: mounts source at dest path
mounts:
  # - ~/.gitconfig                      # Git config (same path)
  # - /host/path:/container/path        # Custom mapping
  # - ~/data:/data                      # Home expansion works

# =============================================================================
# ENV - Environment variables
# =============================================================================
# Supports two formats:
#
# Map format (recommended):
env:
  NREPL_PORT: 7888
  # MY_VAR: "hello"                     # Literal value
  # DEBUG: "true"                       # Another literal
  # EDITOR:                             # Passthrough from host (uncomment to test)

# Array format (alternative):
# env:
#   - MY_VAR=hello                      # Literal with =
#   - DEBUG=true                        # Another literal
#   - EDITOR                            # Passthrough (no =)

# =============================================================================
# PORTS - Port mappings (host:container)
# =============================================================================
# Format: HOST_PORT:CONTAINER_PORT or IP:HOST_PORT:CONTAINER_PORT
ports:
  # - "8080:8080"                       # Web server
  # - "3000:3000"                       # Dev server
  # - "127.0.0.1:5432:5432"             # Postgres (localhost only)
  # - "9090:9090/udp"                   # UDP protocol

# =============================================================================
# DOCKER_ARGS - Additional docker run arguments
# =============================================================================
# Supports string (space-separated) or array format
# WARNING: Some flags are dangerous (--privileged, --network=host, etc.)

# String format:
# docker_args: "--cpus=2 --memory=4g"

# Array format (recommended for complex args):
docker_args:
  # - "--cpus=2"
  # - "--memory=4g"
  # - "--hostname=aishell"
  # - "--add-host=myhost:127.0.0.1"

# =============================================================================
# PRE_START - Command to run before shell starts
# =============================================================================
# Runs in background, output goes to /tmp/pre-start.log
# Useful for starting services needed by your project

pre_start: "bb nrepl-server 7888"

# More complex examples:
# pre_start: "redis-server --daemonize yes"
# pre_start: "docker-compose -f /project/docker-compose.yml up -d"

# =============================================================================
# HARNESS_ARGS - Default arguments for AI harnesses
# =============================================================================
# Per-harness default arguments that are automatically prepended to CLI args.
# Useful for flags you always want (--plugin, --model, etc.)
#
# Merging behavior:
#   - Global and project harness_args concatenate per-harness
#   - Defaults come first, CLI args follow (CLI can override by position)
#   - String values auto-convert to single-element lists

harness_args:
  # claude:
  #   - "--plugin"                         # Plugin flag
  #   - "context7"                         # Plugin name
  #   - "--model"                          # Model flag
  #   - "sonnet"                           # Model name
  # opencode:
  #   - "--provider"
  #   - "anthropic"

# String shorthand (single arg):
# harness_args:
#   claude: "--verbose"                    # Auto-converts to ["--verbose"]

# =============================================================================
# GITLEAKS_FRESHNESS_CHECK - Gitleaks scan freshness warning toggle
# =============================================================================
# When true (default), shows a warning before container launch if gitleaks
# scan is stale (>7 days old) or has never been run. Advisory only - never
# blocks execution.
#
# The warning reminds you to run: aishell gitleaks dir .
#
# Set to false to disable the freshness warning entirely.

gitleaks_freshness_check: true

# To disable:
# gitleaks_freshness_check: false

# =============================================================================
# DETECTION - Sensitive file detection configuration
# =============================================================================
# Controls the filename-based sensitive file detection that runs before
# container launch. Detects .env files, SSH keys, cloud credentials, etc.

detection:
  # Global toggle - set to false to disable all filename detection
  # Default: true (enabled)
  enabled: true

  # Custom patterns - add project-specific sensitive file patterns
  # Extends defaults (doesn't replace). Patterns use glob syntax.
  #
  # Full syntax with reason:
  # custom_patterns:
  #   "*.secret":
  #     severity: high
  #     reason: "Project secret file"
  #   "config/credentials.*":
  #     severity: medium
  #     reason: "Credential config files"
  #
  # Shorthand syntax (severity only):
  # custom_patterns:
  #   "*.frubas": high
  #   "internal/*.key": medium

  custom_patterns:
    # "*.custom-secret":
    #   severity: high
    #   reason: "Custom project secrets"

  # Allowlist - suppress false positives for specific files
  # Each entry requires 'path' and 'reason' keys.
  # Path can be: exact path, filename-only, or glob pattern.
  #
  # Examples:
  #   - path: ".env.ci"                    # Exact filename
  #     reason: "CI template, no secrets"
  #   - path: "test/fixtures/*.key"        # Glob pattern
  #     reason: "Test fixture keys"
  #   - path: "docs/example.pem"           # Specific file
  #     reason: "Documentation example"

  allowlist:
    # - path: ".env.test"
    #   reason: "Test environment template"

tmux:
  plugins:
    - "tmux-plugins/tmux-sensible"
    - "jaclu/tmux-menus"
